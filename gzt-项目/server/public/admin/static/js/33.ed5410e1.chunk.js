(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{555:function(e,t,n){},573:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return x});n(148);var a,r=n(105),o=(n(106),n(14)),s=(n(274),n(276)),i=(n(255),n(254)),c=(n(275),n(277)),p=n(2),u=n.n(p),l=n(56),d=(n(55),n(15)),m=n(260),f=n(261),y=n(264),h=n(262),g=n(265),v=n(10),b=(n(342),n(310)),w=(n(80),n(36)),L=n(1),E=n(32),O=n(544),j=n.n(O),S=(n(555),n(4)),C=w.a.Content,k=b.a.Group,P=b.a.Button,x=Object(E.c)(function(e){return Object(v.a)({},e.Company,{listLoading:e.loading.effects["".concat("Company","/queryDepartmentList")]})},function(e){return{showDepartmentList:function(t){e({type:"".concat("Company","/queryDepartmentList"),payload:t})},showPositionList:function(t){e({type:"".concat("Company","/queryPermissionList"),payload:t})}}})(a=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(y.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={listType:"department",sortLoading:!1,currentPostion:-1},n.saveSortInfo=function(){if("department"===n.state.listType)d.a.success("\u63d0\u4ea4\u6210\u529f");else{n.setState({sortLoading:!0});for(var e=document.body.querySelectorAll(".listWrapper .sortList"),t={},a=0;a<e.length;a++)t[e[a].dataset.type]=a;Object(l.a)(u.a.mark(function e(){var a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.a)("/api/management_job_ordering",{method:"POST",body:{sort_data:t}});case 2:a=e.sent,n.setState({sortLoading:!1}),"success"===a.status?(d.a.success("\u63d0\u4ea4\u6210\u529f"),n.props.history.push("/work/approval/management")):d.a.info("\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~");case 5:case"end":return e.stop()}},e)}))()}},n.onRadionChange=function(e){"department"===e.target.value?n.setState({listType:"department"}):n.setState({listType:"position"})},n.dragulaDecorator=function(e){e&&j()([e]).on("drag",function(e,t){n.setState({currentPostion:Array.from(t.children).findIndex(function(t){return t===e})})}).on("drop",function(e,t,a,r){Object(l.a)(u.a.mark(function a(){return u.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(S.a)("/api/management_department_ordering",{method:"POST",body:{oldOrder:n.state.currentPostion,newOrder:Array.from(t.children).findIndex(function(t){return t===e}),node_id:e.dataset.type}});case 2:"success"!==a.sent.status&&d.a.info("\u670d\u52a1\u5668\u7e41\u5fd9\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5~");case 4:case"end":return a.stop()}},a)}))()})},n}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.showPositionList(),this.props.showDepartmentList()}},{key:"render",value:function(){var e=this.props,t=e.departmentList,n=e.permissionList,a=e.listLoading,p=this.state,u=p.listType,l=p.sortLoading,d="department"===u?t:n;return L.createElement(C,{className:"sort-wrapper wrapper"},L.createElement("div",null,L.createElement(s.a,null,L.createElement(c.a,{span:4},L.createElement(k,{defaultValue:"department",buttonStyle:"solid",onChange:this.onRadionChange},L.createElement(P,{value:"department"},"\u90e8\u95e8"),L.createElement(P,{value:"position"},"\u804c\u52a1"))),L.createElement(c.a,{span:20},L.createElement("div",{className:"text-right"},L.createElement(i.a,{type:"primary",className:"btn",onClick:this.saveSortInfo,loading:l},"\u4fdd\u5b58"),L.createElement(i.a,null,"\u53d6\u6d88")))),L.createElement(r.a,{spinning:a,delay:300},L.createElement("div",{className:"listWrapper",ref:this.dragulaDecorator},d&&d.data.map(function(e,t){var n=e.id,a=e.name;return L.createElement(s.a,{className:"sortList cursor-pointer",key:t,"data-type":n},L.createElement(c.a,null,L.createElement(o.a,{type:"ordered-list",className:"sortIcon"}),"\u540d\u79f0\uff1a",a))})))))}}]),t}(L.Component))||a}}]);
//# sourceMappingURL=33.ed5410e1.chunk.js.map