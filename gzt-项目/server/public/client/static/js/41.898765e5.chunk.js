(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{481:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var r=a(160),n=a(0),s=a.n(n);function o(e){var t=e.text,a=e.colon,n=void 0===a||a,o=Object(r.a)(e,["text","colon"]);return s.a.createElement("span",Object.assign({className:"text-label"},o),t,n?"\uff1a":"")}},884:function(e,t,a){"use strict";a.d(t,"a",function(){return G});var r=a(2),n=a.n(r),s=(a(58),a(12)),o=(a(155),a(94)),c=(a(461),a(462)),l=(a(524),a(522)),i=(a(233),a(13)),p=(a(459),a(460)),u=(a(154),a(93)),m=a(57),d=a(153),h=(a(603),a(604)),f=a(0),b=a.n(f),g=a(89),v=a(481),y=a(3),E=h.a.Meta;function G(e){var t=e.pathname,a=e.params,r=e.type,G=e.onEnableStateChange,_=e.onGroupMove,w=e.changeEnableStateUrl,x=e.deleteUrl,C=e.onDeleteChange,O=Object(f.useState)(!1),k=Object(d.a)(O,2),P=k[0],S=k[1],j=a.allow_user_names,N=a.id,M=a.name,V=a.description,T=a.updated_at,q=a.approval_method,L=a.is_show,I=a.need_approval;function R(){return(R=Object(m.a)(n.a.mark(function e(){var t,a;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),t="export"===r?{id:N,is_show:1===L?"disable":"enable"}:{id:N},e.next=4,Object(y.a)(w,{method:"POST",body:t});case 4:a=e.sent,S(!1),"success"===a.status?(s.a.success(1===L?"\u7981\u7528\u6210\u529f":"\u542f\u7528\u6210\u529f"),G&&G()):s.a.error("\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(){return(D=Object(m.a)(n.a.mark(function e(){var t;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(x){e.next=2;break}return e.abrupt("return");case 2:return S(!0),e.next=5,Object(y.a)(x,{method:"POST",body:{id:N}});case 5:t=e.sent,S(!1),"success"===t.status?(s.a.success("\u5220\u9664\u6210\u529f"),C&&C()):s.a.error("\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var B=1===L?"\u786e\u5b9a\u5220\u9664\u8be5\u6a21\u677f\u5417?\u5220\u9664\u540e\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u5230\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u8bc4\u5ba1\uff0c\u8bf7\u786e\u8ba4\u5f53\u524d\u6a21\u677f\u4e0b\u6ca1\u6709\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u8bc4\u5ba1":"\u786e\u5b9a\u5220\u9664\u8be5\u5ba1\u6279\u6d41\u7a0b\u5417?\u5220\u9664\u540e\uff0c\u53ef\u80fd\u4f1a\u5f71\u54cd\u5230\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u8bc4\u5ba1\uff0c\u8bf7\u786e\u8ba4\u5f53\u524d\u5ba1\u6279\u6d41\u7a0b\u4e0b\u6ca1\u6709\u6b63\u5728\u8fdb\u884c\u4e2d\u7684\u8bc4\u5ba1";return b.a.createElement(o.a,{spinning:P},b.a.createElement(c.a,{type:"flex",style:{padding:"0 10px",alignItems:"center",background:"#fff",borderBottom:"1px solid #ddd"}},b.a.createElement(p.a,{span:"template"===r?6:8},b.a.createElement(h.a,{bordered:!1},b.a.createElement(E,{avatar:b.a.createElement(u.a,{size:"large",shape:"square",style:{background:"#1890ff"}},M),title:M,description:V}))),b.a.createElement(p.a,{span:"template"===r?6:8},"\u66f4\u65b0\u65f6\u95f4\uff1a",b.a.createElement("span",null,T)),"template"===r?!0===I?b.a.createElement(p.a,{span:4},q):b.a.createElement(p.a,{span:4},"\u5f53\u524d\u6a21\u677f\u4e0d\u9700\u8981\u5ba1\u6279"):null,b.a.createElement(p.a,{span:4},b.a.createElement(v.a,{text:"\u53ef\u89c1\u8303\u56f4"}),b.a.createElement("span",{style:{color:"#e8a54c"}},1===j.length?j[0]:j.length>7?"".concat(j.slice(0,7),"\u7b49").concat(j.length,"\u4eba\u53ef\u89c1"):"".concat(j))),b.a.createElement(p.a,{span:4,style:{textAlign:"right"}},t&&b.a.createElement(g.a,{to:{pathname:t,state:{type:"UPDATE",data:{id:N}}}},b.a.createElement("span",{className:"primary-color cursor-pointer",style:{padding:"0 12px"}},"\u7f16\u8f91")),1!==L&&b.a.createElement(l.a,{placement:"topLeft",icon:b.a.createElement(i.a,{type:"question-circle-o",style:{color:"red"}}),title:b.a.createElement("div",{style:{maxWidth:450}},B),onConfirm:function(){return D.apply(this,arguments)},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},b.a.createElement("span",{className:"primary-color cursor-pointer",style:{padding:"0 12px"}},"\u5220\u9664")),b.a.createElement("span",{onClick:function(){return R.apply(this,arguments)},className:"primary-color cursor-pointer",style:{padding:"0 12px"}},1===L?"\u7981\u7528":"\u542f\u7528"),1===L&&b.a.createElement("span",{onClick:function(){_&&_()},className:"primary-color cursor-pointer",style:{padding:"0 12px"}},"\u79fb\u52a8\u5230"))))}},885:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a(461);var r=a(462),n=(a(524),a(522)),s=(a(459),a(460)),o=a(0),c=a.n(o);function l(e){var t=e.type,a=e.count,o=e.onRenameGroup,l=e.onDeleteGroup;return c.a.createElement(r.a,{type:"flex",style:{marginTop:"10px",padding:"0 8px",lineHeight:"40px",background:"#f9f9f9"}},c.a.createElement(s.a,{span:6},c.a.createElement("span",{style:{color:"#222"}},t),c.a.createElement("span",null,"\uff08",a,"\uff09")),c.a.createElement(s.a,{span:18,style:{textAlign:"right"}},c.a.createElement("span",{onClick:function(){o&&o()},className:"primary-color cursor-pointer",style:{padding:"0 12px"}},"\u91cd\u547d\u540d"),0===a?c.a.createElement(n.a,{placement:"left",title:"\u786e\u5b9a\u5220\u9664\u8be5\u5206\u7ec4\u5417\uff1f",onConfirm:function(){l&&l()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},c.a.createElement("span",{className:"primary-color cursor-pointer",style:{padding:"0 12px"}},"\u5220\u9664\u8be5\u7ec4")):null))}},886:function(e,t,a){"use strict";a.d(t,"a",function(){return l});a(603);var r=a(604),n=(a(154),a(93)),s=a(160),o=a(0),c=a(89);function l(e){var t=e.datasource,a=e.pathname,l=e.onItemClick,i=Object(s.a)(e,["datasource","pathname","onItemClick"]);return o.createElement("div",i,t&&t.map(function(e){var t=e.id,s=e.name,i=e.count,p=e.data;return 0!==i&&o.createElement("div",{key:t},o.createElement("div",{style:{marginBottom:16}},s,"\uff08",i,"\uff09"),o.createElement("div",{className:"clearfix"},p.map(function(e){var t=e.id,s=e.name,i=e.description;return o.createElement(c.a,{key:t,to:{pathname:a,state:{type:"INSERT",data:{id:t,name:s}}}},o.createElement(r.a,{size:"small",hoverable:!0,bordered:!0,style:{float:"left",margin:"0 16px 16px 0",width:220},onClick:l},o.createElement(r.a.Meta,{className:"review-tempitem",avatar:o.createElement(n.a,{shape:"square",size:42,style:{background:"#1890ff",fontSize:14}},s&&s.substr(0,2)),title:o.createElement("span",{style:{fontSize:14}},s),description:o.createElement("div",{className:"overflow-ellipsis",style:{fontSize:12}},i)})))})))}))}},961:function(e,t,a){e.exports={groupBtn:"processmgt_groupBtn__1T7gL",create:"processmgt_create__llUIW",header:"processmgt_header__3pbCM",processList:"processmgt_processList__3PLMO",processGroupItem:"processmgt_processGroupItem__1O_1O",active:"processmgt_active__1vVcg"}},990:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return L});a(234);var r,n=a(156),s=(a(456),a(458)),o=(a(155),a(94)),c=(a(461),a(462)),l=(a(459),a(460)),i=(a(120),a(27)),p=a(2),u=a.n(p),m=(a(58),a(12)),d=a(57),h=a(42),f=a(43),b=a(45),g=a(44),v=a(46),y=a(4),E=(a(237),a(157)),G=a(0),_=a(89),w=a(884),x=a(885),C=a(51),O=a(3),k=a(886),P=a(86),S=a(481),j=a(6),N=a.n(j),M=a(961),V=a.n(M),T=E.a.Header,q=E.a.Content,L=Object(C.c)(function(e){return Object(y.a)({},e.Review,{loading:e.loading.effects["".concat("Review","/queryProcesses")]})},function(e){return{queryProcesses:function(){e({type:"".concat("Review","/queryProcesses")})},queryProcessGroup:function(t){e({type:"".concat("Review","/queryProcessGroup"),payload:t})}}})(r=function(e){function t(){var e,a;Object(h.a)(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return(a=Object(b.a)(this,(e=Object(g.a)(t)).call.apply(e,[this].concat(n)))).state={addGroupVisible:!1,processListVisible:!1,processCreateVisible:!1,addGroupValue:"",renameGroup:null,renameGroupVisible:!1,moveToOtherGroupVisible:!1,afterMovingGroup:null,beforeMovingProcess:null},a.handleEnableStateChange=function(){a.props.queryProcesses()},a.handleDeleteChange=function(){a.props.queryProcesses()},a.showAddGroupModal=function(){a.setState({addGroupVisible:!0,addGroupValue:""})},a.addGroup=Object(d.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({addGroupVisible:!1}),e.next=3,Object(O.a)("/api/c_pst_add_process_template_type",{method:"POST",body:{name:a.state.addGroupValue}});case 3:"success"===e.sent.status?(m.a.success("\u65b0\u5efa\u6210\u529f"),a.props.queryProcesses()):m.a.error("\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 5:case"end":return e.stop()}},e)})),a.cancelGroup=function(){a.setState({addGroupVisible:!1})},a.addGroupChange=function(e){a.setState({addGroupValue:e.target.value})},a.showProcessCreateModal=function(){a.setState({processCreateVisible:!0})},a.cancelProcessList=function(){a.setState({processCreateVisible:!1})},a.handleRenameGroup=function(e,t){a.setState({renameGroupVisible:!0,renameGroup:{id:e,name:t,oldName:t,disabled:!0}})},a.renameGroup=Object(d.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({renameGroupVisible:!1}),e.next=3,Object(O.a)("/api/c_pst_alter_process_template_name",{method:"POST",body:{id:a.state.renameGroup.id,name:a.state.renameGroup.name}});case 3:"success"===e.sent.status?(m.a.success("\u91cd\u547d\u540d\u6210\u529f"),a.props.queryProcesses()):m.a.error("\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 5:case"end":return e.stop()}},e)})),a.cancelRenameGroup=function(){a.setState({renameGroupVisible:!1})},a.renameGroupChange=function(e){a.setState({renameGroup:{id:a.state.renameGroup.id,name:e.target.value,oldName:a.state.renameGroup.oldName,disabled:e.target.value===a.state.renameGroup.oldName}})},a.handleDeleteGroup=function(){var e=Object(d.a)(u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.a)("/api/c_pst_delete_process_template_name",{method:"POST",body:{id:t}});case 2:"success"===e.sent.status?(m.a.success("\u5220\u9664\u6210\u529f"),a.props.queryProcesses()):m.a.error("\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleGroupMove=function(e,t,r){a.props.queryProcessGroup(),a.setState({moveToOtherGroupVisible:!0,beforeMovingProcess:{groupId:e,id:t,name:r}})},a.moveToOtherGroup=Object(d.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({moveToOtherGroupVisible:!1}),e.next=3,Object(O.a)("/api/c_pst_move_process_template_type",{method:"POST",body:{template_id:a.state.beforeMovingProcess.id,type_id:a.state.afterMovingGroup.id}});case 3:"success"===e.sent.status?(m.a.success("\u79fb\u52a8\u6210\u529f"),a.props.queryProcesses()):m.a.error("\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");case 5:case"end":return e.stop()}},e)})),a.cancelMove=function(){a.setState({moveToOtherGroupVisible:!1})},a.handleMoveGroupChecked=function(e){Object(P.a)(a.state.beforeMovingProcess.groupId)!==Object(P.a)(e)&&a.setState({afterMovingGroup:{id:e}})},a}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.props.queryProcesses()}},{key:"render",value:function(){var e=this,t=this.props,a=t.processes,r=t.loading,p=t.processGroup,u=this.state,m=u.addGroupVisible,d=u.addGroupValue,h=u.processCreateVisible,f=u.renameGroupVisible,b=u.renameGroup,g=u.moveToOtherGroupVisible,v=u.beforeMovingProcess,y=u.afterMovingGroup;return G.createElement(E.a,{className:"review-processmgt"},G.createElement(T,{className:V.a.header},G.createElement(i.a,{className:V.a.groupBtn,type:"primary",ghost:!0,icon:"folder-add",onClick:this.showAddGroupModal},"\u6dfb\u52a0\u5206\u7ec4"),G.createElement(_.a,{to:"/work/review/processGroupSort"},G.createElement(i.a,{className:V.a.groupBtn,type:"primary",ghost:!0,icon:"sort-ascending"},"\u5206\u7ec4\u6392\u5e8f")),G.createElement(i.a,{type:"primary",className:V.a.create,icon:"plus",onClick:this.showProcessCreateModal},"\u65b0\u5efa\u5ba1\u6279\u6d41\u7a0b")),G.createElement(q,{className:V.a.processList},G.createElement(o.a,{spinning:r},a&&a.enable.map(function(t){var a=t.id,r=t.name,n=t.count,s=t.data;return G.createElement("div",{key:a},G.createElement(x.a,{type:r,count:n,onRenameGroup:function(){return e.handleRenameGroup(a,r)},onDeleteGroup:function(){return e.handleDeleteGroup(a)}}),s&&s.map(function(t,r){return G.createElement(w.a,{key:r,type:"process",params:t,pathname:"/work/review/createProcess",changeEnableStateUrl:"/api/c_pst_switch_process_template_show",onEnableStateChange:e.handleEnableStateChange,onGroupMove:function(){return e.handleGroupMove(a,t.id,t.name)}})}))}),G.createElement(c.a,{type:"flex",style:{marginTop:"10px",padding:"0 8px",lineHeight:"40px",background:"#f9f9f9"}},G.createElement(l.a,{span:4},G.createElement("span",{style:{color:"#222"}},"\u5df2\u7981\u7528"))),a&&a.disable.map(function(t,a){return G.createElement(w.a,{key:a,type:"process",params:t,changeEnableStateUrl:"/api/c_pst_switch_process_template_show",onEnableStateChange:e.handleEnableStateChange,deleteUrl:"/api/c_pst_delete_process_template",onDeleteChange:e.handleDeleteChange})}))),G.createElement(n.a,{visible:m,title:"\u6dfb\u52a0\u5206\u7ec4",onOk:this.addGroup,onCancel:this.cancelGroup},G.createElement(s.a,{onChange:this.addGroupChange,value:d,maxLength:12,placeholder:"\u6700\u591a10\u4e2a\u5b57"})),G.createElement(n.a,{visible:f,title:"\u91cd\u547d\u540d\u5206\u7ec4",onOk:this.renameGroup,onCancel:this.cancelRenameGroup,okButtonProps:{disabled:!b||b.disabled}},G.createElement(s.a,{onChange:this.renameGroupChange,value:b&&b.name,maxLength:12,placeholder:"\u6700\u591a10\u4e2a\u5b57"})),G.createElement(n.a,{closable:!1,visible:g,title:'\u79fb\u52a8 "'.concat(v&&v.name,'" \u81f3'),onOk:this.moveToOtherGroup,onCancel:this.cancelMove,bodyStyle:{padding:0,maxHeight:250,overflowY:"auto"}},p&&p.map(function(t){var a=t.id,r=t.name;return G.createElement("div",{key:a,className:N()("clearfix",V.a.processGroupItem,y&&y.id===a?V.a.active:""),onClick:function(){return e.handleMoveGroupChecked(a)}},G.createElement(S.a,{text:r,colon:!1}),G.createElement("span",{className:"pull-right"},v&&Object(P.a)(v.groupId)===Object(P.a)(a)?"\u5f53\u524d\u6240\u5728\u7ec4":""))})),G.createElement(n.a,{visible:h,title:"\u65b0\u5efa\u5ba1\u6279\u6d41\u7a0b",onCancel:this.cancelProcessList,footer:null,width:800,wrapClassName:"modal-review",getContainer:function(){return document.getElementsByClassName("work-review")[0]}},G.createElement(c.a,{className:"modal-review-sectitle"},G.createElement(l.a,{span:18},G.createElement(i.a,{type:"primary",value:"existingProcess"},"\u4ece\u5df2\u6709\u6d41\u7a0b\u65b0\u5efa")),G.createElement(l.a,{span:6,style:{textAlign:"right"}},G.createElement(_.a,{to:"/work/review/createProcess"},G.createElement(i.a,{onClick:this.cancelProcessList,type:"primary",ghost:!0,icon:"plus"},"\u81ea\u5b9a\u4e49\u6d41\u7a0b")))),G.createElement(k.a,{className:"modal-review-list",datasource:a&&a.enable,pathname:"/work/review/createProcess",onItemClick:this.cancelProcessList})))}}]),t}(G.Component))||r}}]);
//# sourceMappingURL=41.898765e5.chunk.js.map